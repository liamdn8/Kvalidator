apiVersion: v1
data:
  kibana.yml: |
    server.name: kibana
    server.host: "0.0.0.0"

    elasticsearch.requestTimeout: 120000
    elasticsearch.pingTimeout: 30000

    # Security and encryption (critical for HA)
    xpack.security.session.idleTimeout: "1h"
    xpack.security.session.lifespan: "8h"

    elasticsearch.hosts: ["https://elasticsearch-master:9200"]
    elasticsearch.username: "${ELASTIC_USERNAME}"
    elasticsearch.password: "${ELASTIC_PASSWORD}"
    elasticsearch.ssl.certificateAuthorities: ["/usr/share/kibana/config/certs/ca.crt"]
    elasticsearch.ssl.verificationMode: none
    xpack.security.encryptionKey: "xpack_security_encryption_key__1234"
    xpack.encryptedSavedObjects.encryptionKey: "saved_objects_encryption_key_5678"
    xpack.reporting.encryptionKey: "reporting_encryption_key_987654321"
    i18n.locale: "en"
    server.basePath: "/kibana"
    server.rewriteBasePath: true

    monitoring.ui.ccs.enabled: false
kind: ConfigMap
metadata:
  name: kibana-config
  namespace: elk
